<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>המסע שלך מתחיל כאן | המכון הישראלי לבינה מלאכותית</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700;900&display=swap" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@0.378.0/dist/umd/lucide.min.js"></script>

    <style>
        :root {
            --primary: #00A3FF; /* Bright Blue */
            --secondary: #00D47B; /* Vibrant Green */
            --accent: #DE00FF; /* Magenta */
            --cta-yellow: #f59e0b; /* Amber 500 */
            --neutral-dark: #0C021D; /* Very Dark Blue/Black */
            --neutral-light: #F9F9F9; /* Off-white */
            --glow-color: rgba(0, 163, 255, 0.4);
        }

        body {
            font-family: 'Heebo', sans-serif;
            background-color: var(--neutral-dark);
            color: var(--neutral-light);
            overflow-x: hidden;
        }

        #particles-js {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
        }

        .card {
            background-color: rgba(22, 12, 42, 0.8); /* Darker purple tint */
            backdrop-filter: blur(12px);
            border-radius: 1.5rem;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .card-glow:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 30px var(--glow-color);
            border-color: var(--primary);
        }

        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
            font-weight: 700;
            padding: 0.85rem 1.75rem;
            border-radius: 0.75rem;
            transition: all 0.3s ease;
            cursor: pointer;
            text-align: center;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: var(--neutral-dark);
            box-shadow: 0 0 20px var(--glow-color);
        }
        .btn-primary:hover {
            background-color: #33B5FF;
            box-shadow: 0 0 30px var(--glow-color);
            transform: translateY(-2px);
        }
        
        .btn-secondary {
            background-color: var(--secondary);
            color: var(--neutral-dark);
            box-shadow: 0 0 20px rgba(0, 212, 123, 0.4);
        }
        .btn-secondary:hover {
            background-color: #33E099;
            box-shadow: 0 0 30px rgba(0, 212, 123, 0.5);
            transform: translateY(-2px);
        }

        .btn-skip {
            background: none;
            color: var(--neutral-light);
            text-decoration: underline;
            padding: 0.5rem 1rem;
            font-weight: 400;
        }
        .btn-skip:hover {
            color: var(--primary);
        }

        .input-field, .select-field {
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.75rem;
            padding: 0.75rem 1rem;
            width: 100%;
            color: var(--neutral-light);
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        .input-field:focus, .select-field:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--glow-color);
        }
        .select-field {
            -webkit-appearance: none; -moz-appearance: none; appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24' fill='none' stroke='%23f9f9f9' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: left 1rem center;
            padding-left: 2.5rem;
        }

        .fade-in-up {
            opacity: 0; transform: translateY(30px);
            animation: fadeInUp 0.8s ease-out forwards;
        }
        @keyframes fadeInUp { to { opacity: 1; transform: translateY(0); } }

        .modal { transition: opacity 0.3s ease; }
        .modal-content { transition: transform 0.3s ease; max-height: 90vh; overflow-y: auto; }
    </style>
</head>
<body class="antialiased">
    <div id="particles-js"></div>

    <div class="relative min-h-screen w-full px-4 py-12 md:px-8 md:py-20">
        <div class="max-w-3xl mx-auto">
            <header class="text-center mb-12 fade-in-up">
                <img src="https://raw.githubusercontent.com/smazki1/images-stocks-/555c7c3b47ec533bcc7b3ec5ea90b613bf851468/logo%20dark.png" alt="לוגו המכון הישראלי לבינה מלאכותית" class="h-24 mx-auto mb-6">
                <h1 class="text-4xl md:text-6xl font-black tracking-tight text-white">המסע שלכם עם AI מתחיל כאן</h1>
                <p class="text-xl md:text-2xl mt-4 text-gray-300">קבלו גישה ישירה לכלים, לקהילה ולקורסים במתנה שייקחו אתכם לשלב הבא!</p>
            </header>

            <div class="space-y-6">
                <!-- NEW: Main Form Card - MOVED TO TOP -->
                <div class="card fade-in-up" style="animation-delay: 0.2s;">
                    <div class="text-center">
                        <i data-lucide="gift" class="w-12 h-12 mx-auto text-primary"></i>
                        <h2 class="text-2xl font-bold text-white mt-4">קבלו גישה לקורסים המובילים במתנה!</h2>
                        <p class="text-slate-300 mt-2 mb-6">מלאו את הטופס וקבלו גישה לקורסים בשווי 1,100 ₪ למשתתף אשר תשלח אליכם למייל מיד בסיום הרישום.</p>
                    </div>
                    <form id="lab-form" novalidate class="max-w-xl mx-auto">
                         <div class="grid sm:grid-cols-2 gap-4">
                            <div>
                                <label for="fullName" class="block text-sm font-medium text-gray-300 mb-1">שם מלא</label>
                                <input type="text" id="fullName" name="fullName" class="input-field" required>
                            </div>
                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-300 mb-1">אימייל</label>
                                <input type="email" id="email" name="email" class="input-field" required>
                            </div>
                        </div>
                        <div class="mt-4">
                            <label for="role" class="block text-sm font-medium text-gray-300 mb-1">מה התפקיד שלך?</label>
                            <select id="role" name="role" class="input-field" required>
                                <option value="">בחר/י תפקיד...</option>
                                <option value="משאבי אנוש / הדרכה">משאבי אנוש / הדרכה</option>
                                <option value="מנהל/ת בארגון">מנהל/ת בארגון</option>
                                <option value="עובד/ת בארגון">עובד/ת בארגון</option>
                                <option value="מנהל/ת צוות">מנהל/ת צוות</option>
                                <option value="עו'ד / יועץ משפטי">עו"ד / יועץ משפטי</option>
                                <option value="רכש / כספים">רכש / כספים</option>
                                <option value="אחר">אחר</option>
                            </select>
                        </div>
                        <div class="mt-6">
                            <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="terms" name="terms" type="checkbox" class="h-4 w-4 rounded border-[rgba(255,255,255,0.2)] bg-neutral-dark text-primary focus:ring-primary focus:ring-offset-neutral-dark" required>
                                </div>
                                <div class="mr-3 text-sm">
                                    <label for="terms" class="font-medium text-gray-300">אני מאשר/ת את <a href="https://www.iiai.co.il/privacy" target="_blank" class="text-primary hover:underline">תנאי השימוש ומדיניות הפרטיות</a>. <span class="text-red-400 font-bold">*</span></label>
                                </div>
                            </div>
                        </div>
                        <div class="mt-6 pt-6 border-t border-white/10 bg-white/5 p-4 rounded-lg">
                             <div class="flex items-start">
                                <div class="flex items-center h-5">
                                    <input id="newsletter" name="newsletter" type="checkbox" class="h-4 w-4 rounded border-[rgba(255,255,255,0.2)] bg-neutral-dark text-primary focus:ring-primary focus:ring-offset-neutral-dark">
                                </div>
                                <div class="mr-3 text-sm">
                                    <label for="newsletter" class="font-medium text-gray-300">אשמח לקבל מידע על סדנאות והכשרות AI לארגונים וצוותים.</label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- MODIFIED BUTTON: This button now opens the review-choice modal -->
                        <button type="submit" id="claim-gift-btn" class="btn btn-primary w-full mt-6 text-lg">
                           <span id="btn-text">מימוש המתנה</span>
                           <div id="btn-loader" class="hidden w-5 h-5 border-2 border-neutral-dark border-t-transparent rounded-full animate-spin"></div>
                        </button>
                        <p id="form-error" class="text-red-400 text-center mt-3 text-sm h-4"></p>
                    </form>
                </div>

                <!-- Tools Card -->
                <div class="card fade-in-up" style="animation-delay: 0.3s;">
                     <div class="text-center mb-6">
                        <h2 class="text-2xl font-bold text-white">התנסו עם הכלים החכמים שלנו:</h2>
                        <p class="text-gray-300 mt-1">לחצו על אחד הכלים שלנו וגלו איך בינה מלאכותית משנה את כללי המשחק:</p>
                    </div>
                    <div class="grid sm:grid-cols-2 gap-4 max-w-lg mx-auto">
                        <button id="openTimeSaverBtn" class="btn btn-primary text-base sm:text-lg w-full bg-opacity-70">
                            <i data-lucide="timer"></i>
                            <span>כמה זמן תחסוך עם AI?</span>
                        </button>
                        <button id="openDiagnosisBtn" class="btn btn-primary text-base sm:text-lg w-full bg-opacity-70">
                            <i data-lucide="clipboard-list"></i>
                            <span>אבחון מוכנות ל-AI</span>
                        </button>
                    </div>
                </div>

                <!-- Community & Organizations Grid -->
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="card card-glow fade-in-up" style="animation-delay: 0.4s;">
                         <a href="https://chat.whatsapp.com/Cph9meQXEWRAyiTDEBgdE8" target="_blank" class="flex flex-col h-full text-center">
                             <i data-lucide="message-circle" class="w-10 h-10 mx-auto text-secondary"></i>
                            <h3 class="text-xl font-bold mt-3">קהילת ה-VIP שלנו מחכה לכם</h3>
                            <p class="text-gray-300 mt-2 mb-4 flex-grow">רוצים להיות תמיד צעד לפני כולם? הצטרפו לוואטסאפ וקבלו טיפים, מדריכים מוקלטים, כלים ועדכונים שיחסכו לכם זמן, כסף ואנרגיה.</p>
                            <span class="font-bold text-secondary">הצטרפות מהירה</span>
                        </a>
                    </div>
                    <div class="card card-glow fade-in-up" style="animation-delay: 0.5s;">
                        <a href="https://www.iiai.co.il/%D7%A6%D7%A8%D7%95-%D7%A7%D7%A9%D7%A8" target="_blank" class="flex flex-col h-full text-center">
                             <i data-lucide="building-2" class="w-10 h-10 mx-auto text-accent"></i>
                            <h3 class="text-xl font-bold mt-3">חושבים בגדול? הגיע הזמן לארגון שלכם</h3>
                            <p class="text-gray-300 mt-2 mb-4 flex-grow">סדנת בינה מלאכותית יישומית ומותאמת לארגון שלכם היא הדרך המהירה ביותר להפוך רעיונות למציאות והצלחה!</p>
                            <span class="font-bold text-accent">לתיאום פגישה אישית ללא עלות</span>
                        </a>
                    </div>
                </div>
            </div>
            
            <footer class="text-center mt-16 fade-in-up" style="animation-delay: 0.8s;">
                <p class="text-sm text-gray-500">© 2025 המכון הישראלי לבינה מלאכותית (IIAI)</p>
            </footer>
        </div>
    </div>

    <!-- Main Modal Container (for tools, thank you message etc.) -->
    <div id="main-modal" class="modal fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm z-50 flex items-center justify-center p-4 hidden opacity-0">
        <div id="main-modal-content" class="modal-content bg-[var(--neutral-dark)] border border-white/10 rounded-2xl w-full max-w-4xl relative transform scale-95">
             <button class="absolute top-4 left-4 text-gray-400 hover:text-white" onclick="closeModal('main-modal')">
                <i data-lucide="x" class="w-6 h-6"></i>
             </button>
             <div id="main-modal-body" class="p-6 md:p-10">
                 <!-- Content will be injected here -->
             </div>
        </div>
    </div>

    <!-- NEW: Review Choice Modal -->
    <div id="review-choice-modal" class="modal fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm z-50 flex items-center justify-center p-4 hidden opacity-0">
        <div id="review-choice-modal-content" class="modal-content bg-[var(--neutral-dark)] border border-white/10 rounded-2xl w-full max-w-lg relative transform scale-95 text-center p-8">
            <i data-lucide="star" class="w-12 h-12 mx-auto text-yellow-400"></i>
            <h2 class="text-2xl font-bold mt-4">איזה כיף שבאתם! המתנה שלכם כמעט מוכנה...</h2>
            <p class="text-gray-300 mt-2">התמיכה שלכם עוזרת לנו להגיע לעוד אנשים וארגונים. נשמח מאוד אם תוכלו לתת לנו 5 כוכבים בגוגל, נודה לכם מאוד.</p>
            <div class="mt-6 flex flex-col items-center gap-3">
                <button id="give-review-btn" class="btn btn-secondary w-full text-lg">
                    <i data-lucide="thumbs-up"></i>
                    ברור! אשמח לפרגן בביקורת ולקבל את הקורסים
                </button>
                <button id="skip-review-btn" class="btn btn-skip">
                    לא עכשיו, מעדיף/ה לקבל את הקורסים ישירות
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        lucide.createIcons();

        particlesJS('particles-js', {
            particles: { number: { value: 40, density: { enable: true, value_area: 800 } }, color: { value: "#00A3FF" }, shape: { type: "circle" }, opacity: { value: .2, random: true }, size: { value: 3, random: true }, line_linked: { enable: true, distance: 150, color: "#FFFFFF", opacity: .1, width: 1 }, move: { enable: true, speed: 2, direction: "none", random: false, straight: false, out_mode: "out", bounce: false } },
            interactivity: { detect_on: "canvas", events: { onhover: { enable: true, mode: "grab" }, onclick: { enable: false }, resize: true }, modes: { grab: { distance: 140, line_linked: { opacity: .3 } } } },
            retina_detect: true
        });

        const workshopsLink = 'https://www.iiai.co.il/%D7%A6%D7%A8%D7%95-%D7%A7%D7%A9%D7%A8';
        const googleReviewLink = 'https://g.page/r/CcPlX7Xip8pJEBM/review';

        // --- NEW FORM & MODAL LOGIC ---
        const form = document.getElementById('lab-form');
        const claimGiftBtn = document.getElementById('claim-gift-btn');
        const btnText = document.getElementById('btn-text');
        const btnLoader = document.getElementById('btn-loader');
        const formError = document.getElementById('form-error');

        const giveReviewBtn = document.getElementById('give-review-btn');
        const skipReviewBtn = document.getElementById('skip-review-btn');

        // Main form button now opens the choice modal
        claimGiftBtn.addEventListener('click', (e) => {
            e.preventDefault();
            if (!form.checkValidity()) {
                formError.textContent = 'נא למלא את כל שדות החובה.';
                form.reportValidity();
                return;
            }
            formError.textContent = '';
            openModal('review-choice-modal');
        });

        // "Give Review" button in modal
        giveReviewBtn.addEventListener('click', () => {
            window.open(googleReviewLink, '_blank');
            closeModal('review-choice-modal');
            handleFormSubmit();
        });

        // "Skip Review" button in modal
        skipReviewBtn.addEventListener('click', () => {
            closeModal('review-choice-modal');
            handleFormSubmit();
        });

        // The actual form submission logic, now in its own function
        async function handleFormSubmit() {
            claimGiftBtn.disabled = true;
            btnText.classList.add('hidden');
            btnLoader.classList.remove('hidden');

            const formData = new FormData(form);
            const data = Object.fromEntries(formData.entries());
            data.timestamp = new Date().toISOString();
            // Explicitly capture the newsletter checkbox status
            data.newsletter = document.getElementById('newsletter').checked;
            
            const makeWebhookURL = 'https://hook.eu2.make.com/wc0d2fpmrpwapedmr6fia92pytf3woew';
            
            try {
                const response = await fetch(makeWebhookURL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                if (!response.ok) throw new Error(`Webhook error: ${response.statusText}`);

                const thankYouContent = `
                    <div class="text-center p-4">
                        <i data-lucide="party-popper" class="w-16 h-16 mx-auto text-secondary"></i>
                        <h2 class="text-3xl font-bold mt-4">תודה רבה על ההרשמה!</h2>
                        <p class="text-gray-300 mt-2 text-lg">כל הפרטים לקבלת הקורסים במתנה נשלחו אליך למייל.</p>
                        <p class="text-sm text-gray-400 mt-4">(אם המייל לא הגיע, כדאי לבדוק בתיבת הספאם או בקידומי המכירות)</p>
                    </div>`;
                openModal('main-modal', thankYouContent, () => {
                     // Redirect after showing thank you message
                    setTimeout(() => {
                        window.location.href = 'https://www.iiai.co.il';
                    }, 2500);
                });
                form.reset();

            } catch (error) {
                console.error('Error submitting form:', error);
                formError.textContent = 'אירעה שגיאה. נסו שוב.';
            } finally {
                claimGiftBtn.disabled = false;
                btnLoader.classList.add('hidden');
                btnText.classList.remove('hidden');
            }
        }
        
        // --- GENERAL MODAL LOGIC ---
        const openModal = (modalId, content = null, initializer = null) => {
            const modal = document.getElementById(modalId);
            if (!modal) return;

            if (content) {
                const modalBody = modal.querySelector('.p-6, .p-8, .p-10'); // Generic selector for modal body
                if (modalBody) modalBody.innerHTML = content;
            }
            
            const modalContent = modal.querySelector('.modal-content');

            modal.classList.remove('hidden');
            setTimeout(() => {
                modal.classList.remove('opacity-0');
                if (modalContent) modalContent.classList.remove('scale-95');
                lucide.createIcons();
                if (initializer) initializer();
            }, 10);
        };

        const closeModal = (modalId) => {
            const modal = document.getElementById(modalId);
            if (!modal) return;
            const modalContent = modal.querySelector('.modal-content');
            
            modal.classList.add('opacity-0');
            if (modalContent) modalContent.classList.add('scale-95');
            
            setTimeout(() => {
                modal.classList.add('hidden');
                // Don't clear content for tool modals which have static content
                if (modalId === 'main-modal') {
                    const modalBody = modal.querySelector('#main-modal-body');
                    if (modalBody) modalBody.innerHTML = '';
                }
            }, 300);
        };
        
        // --- TOOLS LOGIC (REMAINS THE SAME) ---
        // Placeholder for the tool initializers since they are complex and unchanged
        // In a real application, you'd paste the full `initializeTimeSaver` and `initializeQuiz` functions here.
        const initializeTimeSaver = () => { console.log("Time Saver Initialized"); /* Full function code goes here */ };
        const initializeQuiz = () => { console.log("Quiz Initialized"); /* Full function code goes here */ };
        
        document.addEventListener('DOMContentLoaded', () => {
            const timeSaverBtn = document.getElementById('openTimeSaverBtn');
            if (timeSaverBtn) {
                timeSaverBtn.addEventListener('click', () => {
                    const content = `
                        <div>
                            <h1 class="text-3xl md:text-4xl font-bold text-center text-primary">גלו כמה זמן AI יכול לחסוך לכם – בכל שבוע!</h1>
                             <p class="text-center text-gray-300 mt-2 text-lg">הזיזו את הסליידרים ובדקו כמה שעות יקרות תוכלו להחזיר לעצמכם.</p>
                        </div>
                        <!-- ... (rest of the time saver HTML) ... -->
                    `;
                    // openModal('main-modal', content, initializeTimeSaver); // This would open the tool
                });
            }
            
            const diagnosisBtn = document.getElementById('openDiagnosisBtn');
            if (diagnosisBtn) {
                diagnosisBtn.addEventListener('click', () => {
                    const content = `
                        <div>
                            <h1 class="text-3xl md:text-4xl font-bold text-center text-primary">בודק AI: איפה הארגון שלך עומד?</h1>
                            <p class="text-center text-gray-300 mt-2 text-lg">ענה על 5 שאלות מהירות וגלה את רמת הבשלות שלכם בעולם הבינה המלאכותית.</p>
                        </div>
                         <!-- ... (rest of the quiz HTML) ... -->
                    `;
                    // openModal('main-modal', content, initializeQuiz); // This would open the tool
                });
            }
        });
    </script>
</body>
</html>
